(this.webpackJsonpproject=this.webpackJsonpproject||[]).push([[0],{1571:function(e,t,a){"use strict";a.r(t);var c,n,r=a(1),s=a.n(r),i=a(20),l=a.n(i),o=a(2),d=a(3),u=a(51),j=a.n(u),m="what-to-watch-token",b=function(){var e=j.a.create({baseURL:"https://8.react.pages.academy/wtw",timeout:5e3});return e.interceptors.request.use((function(e){var t=function(){var e=localStorage.getItem(m);return null!==e&&void 0!==e?e:""}();return t&&(e.headers["x-token"]=t),e})),e}(),f=a(11),v=a(16),h=a(5),O=a.n(h),g=a(19);!function(e){e.Root="/",e.Login="/login",e.MyList="/mylist",e.Movie="/films",e.Player="/player",e.NotFound="/404",e.Review="/review",e.Dev="/dev"}(c||(c={})),function(e){e.Movies="/films",e.Comments="/comments",e.Login="/login",e.Logout="/logout",e.Promo="/promo",e.Favorite="/favorite"}(n||(n={}));var x,_=["Overview","Details","Reviews"];!function(e){e.Unknown="UNKNOWN",e.NoAuth="NO_AUTH",e.Auth="AUTH"}(x||(x={}));var p,N,w={ALL:"All genres",ADVENTURES:"Adventure",COMEDIES:"Comedy",CRIME:"Crime",DOCUMENTARY:"Documentary",DRAMAS:"Drama",HORROR:"Horror",KIDS:"Kids & Family",ROMANCE:"Romance",THRILLERS:"Thriller",FANTASIES:"Fantasy"},k=function(e){return{id:e.id,name:e.name,description:e.description,rating:e.rating,director:e.director,starring:e.starring,genre:e.genre,released:e.released,posterImage:e.poster_image,previewImage:e.preview_image,backgroundImage:e.background_image,backgroundColor:e.background_color,videoLink:e.video_link,previewVideoLink:e.preview_video_link,scoresCount:e.scores_count,runTime:e.run_time,isFavorite:e.is_favorite}},S=function(e){return{id:e.id,email:e.email,name:e.name,avatarUrl:e.avatar_url,token:e.token}},y=(a(9),{backgroundColor:"",backgroundImage:"",description:"",genre:"",id:-1,isFavorite:!1,name:"",posterImage:"",previewImage:"",previewVideoLink:"",rating:0,released:0,runTime:0,scoresCount:0,director:"",starring:[],videoLink:""}),C=Object(d.b)("data/loadPoster",Object(g.a)(O.a.mark((function e(){var t,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.get(n.Promo);case 2:return t=e.sent,a=t.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))),M=Object(d.b)("data/loadMovies",Object(g.a)(O.a.mark((function e(){var t,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.get(n.Movies);case 2:return t=e.sent,a=t.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))),A=Object(d.b)("data/loadSimilarMovies",function(){var e=Object(g.a)(O.a.mark((function e(t){var a,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.get("".concat(n.Movies,"/").concat(t,"/similar"));case 2:return a=e.sent,c=a.data,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),R=Object(d.b)("data/loadFavoriteMovies",Object(g.a)(O.a.mark((function e(){var t,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.get(n.Favorite);case 2:return t=e.sent,a=t.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))),I=Object(d.b)("data/loadMovie",function(){var e=Object(g.a)(O.a.mark((function e(t){var a,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.get("".concat(n.Movies,"/").concat(t));case 2:return a=e.sent,c=a.data,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),L=Object(d.b)("data/loadComments",function(){var e=Object(g.a)(O.a.mark((function e(t){var a,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.get("".concat(n.Comments,"/").concat(t));case 2:return a=e.sent,c=a.data,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),D=Object(d.b)("data/addReview",function(){var e=Object(g.a)(O.a.mark((function e(t){var a,c,r,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id,c=t.reviewData,e.next=3,b.post("".concat(n.Comments,"/").concat(a),c);case 3:return r=e.sent,s=r.data,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),E=Object(d.b)("data/changeFavoriteStats",function(){var e=Object(g.a)(O.a.mark((function e(t){var a,c,r,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id,c=t.status,e.next=3,b.post("".concat(n.Favorite,"/").concat(a,"/").concat(c));case 3:return r=e.sent,s=r.data,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),T={promo:y,movies:[],similarMovies:[],favoriteMovies:[],movie:y,isMovieLoaded:!1,comments:[]},F=Object(d.c)({name:"data",initialState:T,reducers:{resetMovie:function(e){e.movie=T.movie}},extraReducers:function(e){e.addCase(M.fulfilled,(function(e,t){e.movies=t.payload.map((function(e){return k(e)}))})).addCase(A.fulfilled,(function(e,t){e.similarMovies=t.payload.map((function(e){return k(e)}))})).addCase(R.fulfilled,(function(e,t){e.favoriteMovies=t.payload.map((function(e){return k(e)}))})).addCase(I.pending,(function(e){e.isMovieLoaded=!1})).addCase(I.fulfilled,(function(e,t){e.movie=k(t.payload),e.isMovieLoaded=!0})).addCase(L.fulfilled,(function(e,t){e.comments=t.payload})).addCase(D.fulfilled,(function(e,t){e.comments=t.payload})).addCase(C.fulfilled,(function(e,t){e.promo=k(t.payload)})).addCase(E.fulfilled,(function(e,t){var a=k(t.payload);e.movies=e.movies.map((function(e){return e.id===a.id?a:e})),e.promo.id===a.id&&(e.promo=a),e.movie.id===a.id&&(e.movie=a)}))}}),P=(F.actions.resetMovie,F.reducer),U=Object(d.b)("user/checkAuthorizationStatus",Object(g.a)(O.a.mark((function e(){var t,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.get(n.Login);case 2:return t=e.sent,a=t.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))),z=Object(d.b)("user/login",function(){var e=Object(g.a)(O.a.mark((function e(t){var a,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.post(n.Login,t);case 2:return a=e.sent,c=a.data,r=c.token,localStorage.setItem(m,r),e.abrupt("return",c);case 6:case"end":return e.stop()}var r}),e)})));return function(t){return e.apply(this,arguments)}}()),B=Object(d.b)("user/logout",Object(g.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.delete(n.Logout);case 2:localStorage.removeItem(m);case 3:case"end":return e.stop()}}),e)})))),H={authorizationStatus:x.NoAuth,authInfo:{id:1/0,name:"",email:"",token:"",avatarUrl:""}},W=Object(d.c)({name:"data",initialState:H,reducers:{},extraReducers:function(e){e.addCase(U.pending,(function(e){e.authorizationStatus=x.Unknown})).addCase(U.fulfilled,(function(e,t){e.authorizationStatus=x.Auth,e.authInfo=S(t.payload)})).addCase(U.rejected,(function(e){e.authorizationStatus=x.NoAuth})).addCase(z.fulfilled,(function(e,t){e.authorizationStatus=x.Auth,e.authInfo=S(t.payload)})).addCase(z.rejected,(function(e){e.authorizationStatus=x.NoAuth,e.authInfo=H.authInfo})).addCase(B.fulfilled,(function(e){e.authorizationStatus=x.NoAuth,e.authInfo=H.authInfo}))}}).reducer;!function(e){e.Data="DATA",e.User="USER"}(N||(N={}));var V=Object(v.c)((p={},Object(f.a)(p,N.Data,P),Object(f.a)(p,N.User,W),p)),K=Object(d.a)({reducer:V,middleware:function(e){return e({thunk:{extraArgument:b}})}}),Y=a(6),q=a(13),J=Object(q.a)(),Z=a(7),G=function(e){return e[N.Data].movies},$=function(e){return e[N.Data].similarMovies},Q=function(e){return e[N.Data].favoriteMovies},X=function(e){return e[N.Data].movie},ee=function(e){return e[N.Data].isMovieLoaded},te=function(e){return e[N.Data].promo},ae=function(e){return e[N.Data].comments},ce=a(15),ne=a.n(ce),re=a(10),se=a(0);var ie=function(){return Object(se.jsx)("div",{className:"logo",children:Object(se.jsxs)(re.a,{to:"/",className:"logo__link",children:[Object(se.jsx)("span",{className:"logo__letter logo__letter--1",children:"W"}),Object(se.jsx)("span",{className:"logo__letter logo__letter--2",children:"T"}),Object(se.jsx)("span",{className:"logo__letter logo__letter--3",children:"W"})]})})},le=function(e){return e[N.User].authorizationStatus},oe=function(e){return e[N.User].authInfo};var de=function(){var e=Object(o.c)(le),t=Object(o.c)(oe).avatarUrl,a=Object(o.b)();return e===x.Auth?Object(se.jsxs)("ul",{className:"user-block",children:[Object(se.jsx)("li",{className:"user-block__item",children:Object(se.jsx)("div",{className:"user-block__avatar",onClick:function(){J.push(c.MyList)},children:Object(se.jsx)("img",{src:t,alt:"User avatar",width:"63",height:"63"})})}),Object(se.jsx)("li",{className:"user-block__item",children:Object(se.jsx)(re.a,{className:"user-block__link",to:c.Root,onClick:function(){a(B()).then((function(){return Z.b.success("\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0432\u044b\u0448\u043b\u0438 \u0438\u0437 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430.")})).catch((function(e){return Z.b.error(e.message)}))},children:"Sign out"})})]}):Object(se.jsx)("div",{className:"user-block",children:Object(se.jsx)(re.a,{className:"user-block__link",to:c.Login,children:"Sign in"})})};var ue=function(e){var t=e.config,a=e.children;return Object(se.jsxs)("header",{className:ne()("page-header",{"film-card__head":t.rootPage,"user-page__head":t.myListPage}),children:[Object(se.jsx)(ie,{}),t.myListPage&&Object(se.jsx)("h1",{className:"page-title user-page__title",children:"My list"}),t.reviewPage&&a,Object(se.jsx)(de,{})]})};var je=function(e){var t=e.previewUrl,a=e.previewAltText,c=e.config;return Object(se.jsx)("div",{className:ne()("film-card__poster",{"film-card__poster--big":c.bigSize,"film-card__poster--small":c.smallSize}),children:Object(se.jsx)("img",{src:t,alt:a,width:"218",height:"327"})})};var me=function(e){var t=e.isFavorite,a=e.onButtonClick;return Object(se.jsxs)("button",{className:"btn btn--list film-card__button",type:"button",onClick:a,children:[Object(se.jsx)("svg",{viewBox:"0 0 19 19",width:"19",height:"19",children:Object(se.jsx)("use",{xlinkHref:t?"#in-list":"#add"})}),Object(se.jsx)("span",{children:"My list"})]})};var be=function(e){var t=e.id;return Object(se.jsxs)("button",{className:"btn btn--play film-card__button",type:"button",onClick:function(){J.push("".concat(c.Player,"/").concat(t))},children:[Object(se.jsx)("svg",{viewBox:"0 0 19 19",width:"19",height:"19",children:Object(se.jsx)("use",{xlinkHref:"#play-s"})}),Object(se.jsx)("span",{children:"Play"})]})};var fe=function(e){var t=e.movieData,a=Object(o.b)();return Object(se.jsxs)("div",{className:"film-card__info",children:[Object(se.jsx)(je,{previewUrl:t.posterImage,previewAltText:t.name,config:{bigSize:!1}}),Object(se.jsxs)("div",{className:"film-card__desc",children:[Object(se.jsx)("h2",{className:"film-card__title",children:t.name}),Object(se.jsxs)("p",{className:"film-card__meta",children:[Object(se.jsx)("span",{className:"film-card__genre",children:t.genre}),Object(se.jsx)("span",{className:"film-card__year",children:t.released})]}),Object(se.jsxs)("div",{className:"film-card__buttons",children:[Object(se.jsx)(be,{id:t.id}),Object(se.jsx)(me,{isFavorite:t.isFavorite,onButtonClick:function(){var e=t.isFavorite?0:1,c=t.id;a(E({id:c,status:e})).then(d.d).then((function(e){var t=e.is_favorite?"\u0424\u0438\u043b\u044c\u043c \u0431\u044b\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0432 \u0432\u0430\u0448 \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e":"\u0424\u0438\u043b\u044c\u043c \u0431\u044b\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0443\u0434\u0430\u043b\u0435\u043d \u0438\u0437 \u0432\u0430\u0448\u0435\u0433\u043e \u0441\u043f\u0438\u0441\u043a\u0430 \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e";Z.b.success(t)})).catch((function(e){Z.b.error(e.message)}))}})]})]})]})};var ve=function(){var e=Object(o.c)(le),t=Object(o.c)(te);return Object(se.jsxs)("section",{className:"film-card",children:[Object(se.jsx)("div",{className:"film-card__bg",children:Object(se.jsx)("img",{src:e===x.Auth?t.backgroundImage:"img/bg-header.jpg",alt:t.name})}),Object(se.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(se.jsx)(ue,{config:{rootPage:!0,reviewPage:!1,myListPage:!1}}),Object(se.jsx)("div",{className:"film-card__wrap",children:Object(se.jsx)(fe,{movieData:t})})]})};var he,Oe=function(){return Object(se.jsxs)("footer",{className:"page-footer",children:[Object(se.jsx)(ie,{}),Object(se.jsx)("div",{className:"copyright",children:Object(se.jsx)("p",{children:"\xa9 2019 What to watch Ltd."})})]})},ge=a(8),xe=(he={},Object(f.a)(he,w.ALL,(function(e){return e})),Object(f.a)(he,w.ADVENTURES,(function(e){return e.filter((function(e){return e.genre===w.ADVENTURES}))})),Object(f.a)(he,w.COMEDIES,(function(e){return e.filter((function(e){return e.genre===w.COMEDIES}))})),Object(f.a)(he,w.CRIME,(function(e){return e.filter((function(e){return e.genre===w.CRIME}))})),Object(f.a)(he,w.DOCUMENTARY,(function(e){return e.filter((function(e){return e.genre===w.DOCUMENTARY}))})),Object(f.a)(he,w.DRAMAS,(function(e){return e.filter((function(e){return e.genre===w.DRAMAS}))})),Object(f.a)(he,w.HORROR,(function(e){return e.filter((function(e){return e.genre===w.HORROR}))})),Object(f.a)(he,w.KIDS,(function(e){return e.filter((function(e){return e.genre===w.KIDS}))})),Object(f.a)(he,w.ROMANCE,(function(e){return e.filter((function(e){return e.genre===w.ROMANCE}))})),Object(f.a)(he,w.THRILLERS,(function(e){return e.filter((function(e){return e.genre===w.THRILLERS}))})),Object(f.a)(he,w.FANTASIES,(function(e){return e.filter((function(e){return e.genre===w.FANTASIES}))})),he);var _e=function(e){var t=e.onButtonClick;return Object(se.jsx)("button",{className:"catalog__button",type:"button",onClick:t,children:"Show more"})};var pe=function(e){var t=e.src,a=e.previewImage;return Object(se.jsx)("video",{src:t,className:"player__video",poster:a,muted:!0,autoPlay:!0})};var Ne=function(e){var t=e.movie,a=e.selectedMovieId,n=e.onMouseEnter,s=Object(r.useRef)(null);return Object(r.useEffect)((function(){return function(){s.current&&clearTimeout(s.current)}}),[]),Object(se.jsxs)("article",{className:"small-film-card catalog__films-card",onMouseEnter:function(){s.current=setTimeout((function(){n(t.id)}),1e3)},onMouseLeave:function(){s.current&&clearTimeout(s.current),n(-1)},children:[Object(se.jsx)("div",{className:"small-film-card__image",onClick:function(){J.push("".concat(c.Movie,"/").concat(t.id))},children:t.id===a?Object(se.jsx)(pe,{src:t.previewVideoLink,previewImage:t.previewImage}):Object(se.jsx)("img",{src:t.previewImage,alt:t.name,width:"280",height:"175"})}),Object(se.jsx)("h3",{className:"small-film-card__title",children:Object(se.jsx)(re.a,{className:"small-film-card__link",to:"".concat(c.Movie,"/").concat(t.id),children:t.name})})]})};var we=function(e){var t=e.movies,a=Object(r.useState)(-1),c=Object(ge.a)(a,2),n=c[0],s=c[1];return Object(se.jsx)("div",{className:"catalog__films-list",children:t.map((function(e){return Object(se.jsx)(Ne,{movie:e,selectedMovieId:n,onMouseEnter:s},e.id)}))})};var ke=function(e){var t=e.genre,a=e.selectedFilter,n=e.onButtonClick;return Object(se.jsx)("li",{className:ne()("catalog__genres-item",{"catalog__genres-item--active":t===a}),children:Object(se.jsx)(re.a,{className:"catalog__genres-link",to:c.Root,onClick:function(){n(t)},children:t})})};var Se=function(e){var t=e.selectedFilter,a=e.onFilterChange;return Object(se.jsx)("ul",{className:"catalog__genres-list",children:Object.values(w).map((function(e){return Object(se.jsx)(ke,{genre:e,selectedFilter:t,onButtonClick:a},"".concat(e,"-").concat(Math.random()))}))})};var ye=function(e){var t=e.movies,a=Object(r.useState)(8),c=Object(ge.a)(a,2),n=c[0],s=c[1],i=Object(r.useState)(w.ALL),l=Object(ge.a)(i,2),o=l[0],d=l[1],u=Object(r.useState)(t),j=Object(ge.a)(u,2),m=j[0],b=j[1];return Object(r.useEffect)((function(){b(xe[o](t)),s(8)}),[o,t]),Object(se.jsxs)("section",{className:"catalog",children:[Object(se.jsx)("h2",{className:"catalog__title visually-hidden",children:"Catalog"}),Object(se.jsx)(Se,{onFilterChange:d,selectedFilter:o}),Object(se.jsx)(we,{movies:m.slice(0,n)}),t.length>0&&m.length>n&&Object(se.jsx)("div",{className:"catalog__more",children:Object(se.jsx)(_e,{onButtonClick:function(){n+8>=m.length?s(m.length):s(n+8)}})})]})};var Ce=function(){return Object(se.jsxs)("div",{className:"cssload-loader",children:[Object(se.jsx)("h2",{className:"visually-hidden",children:"Loader"}),Object(se.jsx)("div",{className:"cssload-inner cssload-one"}),Object(se.jsx)("div",{className:"cssload-inner cssload-two"}),Object(se.jsx)("div",{className:"cssload-inner cssload-three"})]})};var Me=function(){var e=Object(o.c)(G),t=Object(o.b)();return Object(r.useEffect)((function(){t(M()).then(d.d).catch((function(e){return Z.b.error(e.message)})),t(C()).then(d.d).catch((function(e){return Z.b.error(e.message)}))}),[t]),e.length?Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(ve,{}),Object(se.jsxs)("div",{className:"page-content",children:[Object(se.jsx)(ye,{movies:e}),Object(se.jsx)(Oe,{})]})]}):Object(se.jsx)(Ce,{})};var Ae=function(e){var t=e.message;return Object(se.jsx)("div",{className:"sign-in__message",children:Object(se.jsx)("p",{children:t})})},Re=function(e){return/\S+@\S+\.\S+/.test(e)},Ie=function(e){return/^(?=.*[aA-zZ])(?=.*\d)[aA-zZ\d]{1,}$/.test(e)};var Le=function(){var e=Object(o.c)(le),t=Object(r.useState)(""),a=Object(ge.a)(t,2),n=a[0],s=a[1],i=Object(r.useState)(""),l=Object(ge.a)(i,2),u=l[0],j=l[1],m=Object(r.useState)(""),b=Object(ge.a)(m,2),f=b[0],v=b[1],h=Object(r.useState)(!1),O=Object(ge.a)(h,2),g=O[0],_=O[1],p=Object(r.useState)(!1),N=Object(ge.a)(p,2),w=N[0],k=N[1],S=Object(o.b)();return e===x.Auth?Object(se.jsx)(Y.a,{to:c.Root}):Object(se.jsxs)("div",{className:"user-page",children:[Object(se.jsxs)("header",{className:"page-header user-page__head",children:[Object(se.jsx)(ie,{}),Object(se.jsx)("h1",{className:"page-title user-page__title",children:"Sign in"})]}),Object(se.jsx)("div",{className:"sign-in user-page__content",children:Object(se.jsxs)("form",{action:"#",className:"sign-in__form",onSubmit:function(e){switch(e.preventDefault(),!0){case!Re(n):return v("Please enter a valid email address"),void _(!0);case!Ie(u):return v("Please enter a valid password"),void k(!0);case!Re(n)&&!Ie(u.toString()):return void v("We can\u2019t recognize this email and password combination. Please try again.")}S(z({email:n,password:u})).then(d.d).then((function(){J.goBack()})).catch((function(){return Z.b.error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0432\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442")}))},noValidate:!0,children:[Object(se.jsx)(Ae,{message:f}),Object(se.jsxs)("div",{className:"sign-in__fields",children:[Object(se.jsxs)("div",{className:ne()("sign-in__field",{"sign-in__field--error":g}),children:[Object(se.jsx)("input",{className:"sign-in__input",type:"email",placeholder:"Email address",name:"user-email",id:"user-email",value:n,onChange:function(e){s(e.target.value),g&&(v(""),_(!1))}}),Object(se.jsx)("label",{className:"sign-in__label visually-hidden",htmlFor:"user-email",children:"Email address"})]}),Object(se.jsxs)("div",{className:ne()("sign-in__field",{"sign-in__field--error":w}),children:[Object(se.jsx)("input",{className:"sign-in__input",type:"password",placeholder:"Password",name:"user-password",id:"user-password",value:u,onChange:function(e){j(e.target.value),w&&(v(""),k(!1))}}),Object(se.jsx)("label",{className:"sign-in__label visually-hidden",htmlFor:"user-password",children:"Password"})]})]}),Object(se.jsx)("div",{className:"sign-in__submit",children:Object(se.jsx)("button",{className:"sign-in__btn",type:"submit",children:"Sign in"})})]})}),Object(se.jsx)(Oe,{})]})};var De=function(e){var t=e.tab,a=e.activeTab,c=(e.path,e.onClick);return Object(se.jsx)("li",{className:ne()("film-nav__item",{"film-nav__item--active":a===t}),children:Object(se.jsx)(re.a,{to:"#",className:"film-nav__link",onClick:function(e){e.preventDefault(),c(t)},children:t})})};var Ee=function(e){var t=e.activeTab,a=e.onClick,c=e.path;return Object(se.jsx)("nav",{className:"film-nav film-card__nav",children:Object(se.jsx)("ul",{className:"film-nav__list",children:_.map((function(e){return Object(se.jsx)(De,{tab:e,activeTab:t,path:c,onClick:a},e)}))})})},Te=function(e){var t=Math.floor(e/60),a=e%60;return String(t).padStart(2,"0"),String(a).padStart(2,"0"),"".concat(t,"h ").concat(a,"m")};var Fe=function(e){var t=e.movie,a=e.config;return Object(se.jsx)("div",{className:ne()("film-card__text",{"film-card__row":a.detailsTab}),children:a.detailsTab?Object(se.jsxs)(se.Fragment,{children:[Object(se.jsxs)("div",{className:"film-card__text-col",children:[Object(se.jsxs)("p",{className:"film-card__details-item",children:[Object(se.jsx)("strong",{className:"film-card__details-name",children:"Director"}),Object(se.jsx)("span",{className:"film-card__details-value",children:t.director})]}),Object(se.jsxs)("p",{className:"film-card__details-item",children:[Object(se.jsx)("strong",{className:"film-card__details-name",children:"Starring"}),Object(se.jsx)("span",{className:"film-card__details-value",style:{whiteSpace:"pre"},children:t.starring.map((function(e,t,a){return t===a.length-1?e:"".concat(e,",  \n")}))})]})]}),Object(se.jsxs)("div",{className:"film-card__text-col",children:[Object(se.jsxs)("p",{className:"film-card__details-item",children:[Object(se.jsx)("strong",{className:"film-card__details-name",children:"Run Time"}),Object(se.jsx)("span",{className:"film-card__details-value",children:Te(t.runTime)})]}),Object(se.jsxs)("p",{className:"film-card__details-item",children:[Object(se.jsx)("strong",{className:"film-card__details-name",children:"Genre"}),Object(se.jsx)("span",{className:"film-card__details-value",children:t.genre})]}),Object(se.jsxs)("p",{className:"film-card__details-item",children:[Object(se.jsx)("strong",{className:"film-card__details-name",children:"Released"}),Object(se.jsx)("span",{className:"film-card__details-value",children:t.released})]})]})]}):Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)("p",{children:t.description}),Object(se.jsx)("p",{className:"film-card__director",children:Object(se.jsxs)("strong",{children:["Director: ",t.director]})}),Object(se.jsx)("p",{className:"film-card__starring",children:Object(se.jsxs)("strong",{children:["Starring: ",t.starring.map((function(e){return"".concat(e,", ")}))," and other"]})})]})})},Pe=function(e){switch(!0){case e>0&&e<3:return"Bad";case e>=3&&e<8:return"Normal";case e>=8&&e<10:return"Very good";case e>=10:return"Awesome"}};var Ue=function(e){var t=e.movie;return Object(se.jsxs)("div",{className:"film-rating",children:[Object(se.jsx)("div",{className:"film-rating__score",children:t.rating}),Object(se.jsxs)("p",{className:"film-rating__meta",children:[Object(se.jsx)("span",{className:"film-rating__level",children:Pe(t.rating)}),Object(se.jsxs)("span",{className:"film-rating__count",children:[t.scoresCount," ratings"]})]})]})},ze=a(52);var Be=function(e){var t=e.comment,a=new Date(t.date),c="".concat(a.getFullYear(),"-").concat(a.getMonth(),"-").concat(a.getDate());return Object(se.jsxs)("div",{className:"review",children:[Object(se.jsxs)("blockquote",{className:"review__quote",children:[Object(se.jsx)("p",{className:"review__text",children:t.comment}),Object(se.jsxs)("footer",{className:"review__details",children:[Object(se.jsx)("cite",{className:"review__author",children:t.user.name}),Object(se.jsx)("time",{className:"review__date",dateTime:c,children:a.toLocaleString("en-US",{day:"numeric",year:"numeric",month:"long"})})]})]}),Object(se.jsx)("div",{className:"review__rating",children:t.rating})]})};var He=function(e){var t=e.comments,a=function(e){if(e.length<3)return[Object(ze.a)(e)];for(var t=[],a=0;a<e.length;a+=3)t.push(e.slice(a,a+3));return t}(t);return t.length?Object(se.jsx)("div",{className:"film-card__reviews film-card__row",children:a.map((function(e){return Object(se.jsx)("div",{className:"film-card__reviews-col",children:e.map((function(e){return Object(se.jsx)(Be,{comment:e},e.id)}))},"col-".concat(Math.random()))}))}):Object(se.jsx)("p",{style:{color:"black"},children:"No reviews yet."})};var We=function(){var e=Object(o.c)(le),t=Object(o.c)(X),a=Object(o.c)($),n=Object(o.c)(ee),s=Object(o.c)(ae),i=Object(r.useState)(-1),l=Object(ge.a)(i,2),u=l[0],j=l[1],m=Object(r.useState)("Overview"),b=Object(ge.a)(m,2),f=b[0],v=b[1],h=Object(Y.g)().id,O=Object(o.b)();return Object(r.useEffect)((function(){O(I(+h)),O(A(+h)).catch((function(){Z.b.error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u0445\u043e\u0436\u0438\u0445 \u0444\u0438\u043b\u044c\u043c\u043e\u0432.")})),O(L(+h)).catch((function(){Z.b.error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043e\u0442\u0437\u044b\u0432\u044b.")}))}),[h,O]),n?Object(se.jsxs)(se.Fragment,{children:[Object(se.jsxs)("section",{className:"film-card film-card--full",children:[Object(se.jsxs)("div",{className:"film-card__hero",children:[Object(se.jsx)("div",{className:"film-card__bg",children:Object(se.jsx)("img",{src:t.backgroundImage,alt:t.name})}),Object(se.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(se.jsx)(ue,{config:{myListPage:!1,reviewPage:!1,rootPage:!0}}),Object(se.jsx)("div",{className:"film-card__wrap",children:Object(se.jsxs)("div",{className:"film-card__desc",children:[Object(se.jsx)("h2",{className:"film-card__title",children:t.name}),Object(se.jsxs)("p",{className:"film-card__meta",children:[Object(se.jsx)("span",{className:"film-card__genre",children:t.genre}),Object(se.jsx)("span",{className:"film-card__year",children:t.released})]}),Object(se.jsxs)("div",{className:"film-card__buttons",children:[Object(se.jsx)(be,{id:t.id}),Object(se.jsx)(me,{isFavorite:t.isFavorite,onButtonClick:function(){O(E({id:t.id,status:t.isFavorite?0:1})).then(d.d).then((function(e){var t=e.is_favorite?"\u0424\u0438\u043b\u044c\u043c \u0431\u044b\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0432 \u0432\u0430\u0448 \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e":"\u0424\u0438\u043b\u044c\u043c \u0431\u044b\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0443\u0434\u0430\u043b\u0435\u043d \u0438\u0437 \u0432\u0430\u0448\u0435\u0433\u043e \u0441\u043f\u0438\u0441\u043a\u0430 \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e";Z.b.success(t)})).catch((function(e){Z.b.error(e.message)}))}}),e===x.Auth&&Object(se.jsx)(re.a,{className:"btn film-card__button",to:"".concat(J.location.pathname).concat(c.Review),children:"Add review"})]})]})})]}),Object(se.jsx)("div",{className:"film-card__wrap film-card__translate-top",children:Object(se.jsxs)("div",{className:"film-card__info",children:[Object(se.jsx)(je,{previewUrl:t.posterImage,previewAltText:t.name,config:{bigSize:!0}}),Object(se.jsxs)("div",{className:"film-card__desc",children:[Object(se.jsx)(Ee,{activeTab:f,onClick:v,path:"/films/1"}),"Overview"===f&&Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(Ue,{movie:t}),Object(se.jsx)(Fe,{movie:t,config:{detailsTab:!1}})]}),"Details"===f&&Object(se.jsx)(Fe,{movie:t,config:{detailsTab:!0}}),"Reviews"===f&&Object(se.jsx)(He,{comments:s})]})]})})]}),Object(se.jsxs)("div",{className:"page-content",children:[Object(se.jsxs)("section",{className:"catalog catalog--like-this",children:[Object(se.jsx)("h2",{className:"catalog__title",children:"More like this"}),Object(se.jsx)("div",{className:"catalog__films-list",children:a.map((function(e){return Object(se.jsx)(Ne,{movie:e,selectedMovieId:u,onMouseEnter:j},e.id)}))})]}),Object(se.jsx)(Oe,{})]})]}):Object(se.jsx)(Ce,{})};var Ve=function(){var e=Object(o.c)(le),t=Object(o.c)(Q),a=Object(r.useState)(-1),n=Object(ge.a)(a,2),s=n[0],i=n[1],l=Object(o.b)();return Object(r.useEffect)((function(){l(R())}),[l]),e!==x.Auth&&J.push(c.Login),Object(se.jsxs)("div",{className:"user-page",children:[Object(se.jsx)(ue,{config:{myListPage:!0,rootPage:!1,reviewPage:!1}}),Object(se.jsxs)("section",{className:"catalog",children:[Object(se.jsx)("h2",{className:"catalog__title visually-hidden",children:"Catalog"}),Object(se.jsx)("div",{className:"catalog__films-list",children:t.map((function(e){return Object(se.jsx)(Ne,{selectedMovieId:s,onMouseEnter:i,movie:e},e.id)}))})]}),Object(se.jsx)(Oe,{})]})};var Ke=function(e){var t=e.count,a=e.selectedCount,c=e.isDisabled,n=e.onChange;return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)("input",{className:"rating__input",id:"star-".concat(t),type:"radio",name:"rating",value:t,checked:a===t,onChange:function(){n(t)},disabled:c}),Object(se.jsxs)("label",{className:"rating__label",htmlFor:"star-".concat(t),children:["Rating ",t]})]})},Ye=[10,9,8,7,6,5,4,3,2,1];var qe=function(){var e=Object(o.c)(le),t=Object(o.c)(X),a=Object(r.useState)(0),n=Object(ge.a)(a,2),s=n[0],i=n[1],l=Object(r.useState)(""),u=Object(ge.a)(l,2),j=u[0],m=u[1],b=Object(r.useState)(!1),f=Object(ge.a)(b,2),v=f[0],h=f[1],O=Object(Y.g)().id,g=Object(o.b)();return e!==x.Auth&&J.push(c.Login),Object(se.jsxs)("section",{className:"film-card film-card--full",children:[Object(se.jsxs)("div",{className:"film-card__header",children:[Object(se.jsx)("div",{className:"film-card__bg",children:Object(se.jsx)("img",{src:t.backgroundImage,alt:t.name})}),Object(se.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(se.jsx)(ue,{config:{myListPage:!1,reviewPage:!0,rootPage:!1},children:Object(se.jsx)("nav",{className:"breadcrumbs",children:Object(se.jsxs)("ul",{className:"breadcrumbs__list",children:[Object(se.jsx)("li",{className:"breadcrumbs__item",children:Object(se.jsx)(re.a,{to:"#",className:"breadcrumbs__link",onClick:function(e){e.preventDefault(),J.goBack()},children:t.name})}),Object(se.jsx)("li",{className:"breadcrumbs__item",children:Object(se.jsx)(re.a,{to:"#",className:"breadcrumbs__link",children:"Add review"})})]})})}),Object(se.jsx)(je,{previewUrl:t.posterImage,previewAltText:t.name,config:{bigSize:!1,smallSize:!0}})]}),Object(se.jsx)("div",{className:"add-review",children:Object(se.jsxs)("form",{action:"#",className:"add-review__form",onSubmit:function(e){e.preventDefault(),h(!0),g(D({id:+O,reviewData:{rating:s,comment:j}})).then(d.d).then((function(){Z.b.success("\u0412\u0430\u0448 \u043e\u0442\u0437\u044b\u0432 \u0431\u044b\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d."),h(!1),J.goBack()})).catch((function(){Z.b.error("\u041f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u043e\u0442\u0437\u044b\u0432\u0430, \u0432\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430."),h(!1)}))},children:[Object(se.jsx)("div",{className:"rating",children:Object(se.jsx)("div",{className:"rating__stars",children:Ye.map((function(e){return Object(se.jsx)(Ke,{count:e,selectedCount:s,onChange:i,isDisabled:v},e)}))})}),Object(se.jsxs)("div",{className:"add-review__text",children:[Object(se.jsx)("textarea",{className:"add-review__textarea",name:"review-text",id:"review-text",placeholder:"Review text",minLength:50,maxLength:400,value:j,onChange:function(e){m(e.target.value)},disabled:v}),Object(se.jsx)("div",{className:"add-review__submit",children:Object(se.jsx)("button",{className:"add-review__btn",type:"submit",disabled:j.length<50||0===s||v,children:"Post"})})]})]})})]})};var Je=function(){var e=Object(o.c)(X),t=Object(r.useRef)(null);return Object(se.jsxs)("div",{className:"player",children:[Object(se.jsx)("video",{src:e.videoLink,className:"player__video",poster:e.backgroundImage,ref:t,preload:"metadata",controls:!0}),Object(se.jsx)("button",{type:"button",className:"player__exit",onClick:function(){J.goBack()},children:"Exit"})]})};var Ze=function(){return Object(se.jsx)(Y.c,{history:J,children:Object(se.jsxs)(Y.d,{children:[Object(se.jsx)(Y.b,{path:c.Root,exact:!0,children:Object(se.jsx)(Me,{})}),Object(se.jsx)(Y.b,{path:c.Login,exact:!0,children:Object(se.jsx)(Le,{})}),Object(se.jsx)(Y.b,{path:"".concat(c.Movie,"/:id"),exact:!0,children:Object(se.jsx)(We,{})}),Object(se.jsx)(Y.b,{path:c.MyList,exact:!0,children:Object(se.jsx)(Ve,{})}),Object(se.jsx)(Y.b,{path:"".concat(c.Movie,"/:id").concat(c.Review),exact:!0,children:Object(se.jsx)(qe,{})}),Object(se.jsx)(Y.b,{path:"".concat(c.Player,"/:id"),exact:!0,children:Object(se.jsx)(Je,{})})]})})};a(1570);K.dispatch(U()).then((function(){l.a.render(Object(se.jsx)(s.a.StrictMode,{children:Object(se.jsxs)(o.a,{store:K,children:[Object(se.jsx)(Ze,{}),Object(se.jsx)(Z.a,{})]})}),document.getElementById("root"))}))}},[[1571,1,2]]]);
//# sourceMappingURL=main.7b281697.chunk.js.map